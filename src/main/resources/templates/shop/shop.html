<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}">
    <title th:text="${viewData.shopOwner.id} + '님의 상점'">상점</title>
    <link rel="stylesheet" th:href="@{/css/shop/shop-common.css}">
    <link rel="stylesheet" th:href="@{/css/product/product.css}">
</head>
<body>

<div layout:fragment="content" class="container mt-4 main-content-padding">
    <div th:replace="fragments/shop-header :: shopHeader('상품')"></div>

    <div class="row">
        <div class="col-md-3 mb-4" th:each="product : ${viewData.products}">
            <a th:href="@{/products/{id}(id=${product.id})}" class="text-decoration-none text-dark">
                <div class="card h-100">
                    <div class="sold-out-overlay">
                        <img th:src="${product.thumbnailUrl}" class="card-img-top" alt="상품 이미지">
                        <div class="sold-out-label"
                             th:if="${product.status.name() != 'SELLING'}"
                             th:text="${product.status.name() == 'RESERVED' ? '예약중' : '판매완료'}">
                        </div>
                    </div>

                    <div class="card-body d-flex flex-column justify-content-between">
                        <h5 class="card-title text-truncate" th:text="${product.title}">상품명</h5>
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <p class="card-text mb-0" th:text="${#numbers.formatInteger(product.price, 3, 'COMMA')} + '원'">0원</p>
                            <small class="text-muted" th:text="${product.createdAt}">1분 전</small>
                        </div>
                    </div>
                </div>
            </a>
        </div>
    </div>

    <div class="pagination" th:if="${viewData.products.totalPages > 1}">
        <a th:if="${viewData.products.hasPrevious()}"
           th:href="@{/shop/{id}(id=${viewData.shopOwner.id}, page=${viewData.products.number - 1})}">&lt;</a>
        <th:block th:each="i : ${#numbers.sequence(0, viewData.products.totalPages - 1)}">
            <a th:href="@{/shop/{id}(id=${viewData.shopOwner.id}, page=${i})}"
               th:text="${i + 1}"
               th:classappend="${i == viewData.products.number} ? 'active'">1</a>
        </th:block>
        <a th:if="${viewData.products.hasNext()}"
           th:href="@{/shop/{id}(id=${viewData.shopOwner.id}, page=${viewData.products.number + 1})}">&gt;</a>
    </div>

    <script th:src="@{/js/shop/shop.js}"></script>
</div>
</body>
</html>
